{% extends 'core/base.html' %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<section class="mt-6 rounded-2xl bg-slate-100 px-6 py-10">
  <div class="flex items-center justify-between gap-4">
    <h2 class="text-2xl font-extrabold tracking-tight">My items</h2>
    <a href="{% url 'item:new' %}"
       class="inline-flex items-center rounded-xl bg-emerald-600 px-4 py-2 font-semibold text-white hover:bg-emerald-700">
      New item
    </a>
  </div>
  <p class="mt-1 text-slate-600">
    You have {{ items|length }} item{{ items|length|pluralize }}.
  </p>

  {% if items %}
    <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for item in items %}
        <div class="group rounded-2xl overflow-hidden border border-slate-200 bg-white shadow-sm hover:shadow-md transition-shadow">
          <!-- Thumb (show full image) -->
          <a href="{% url 'item:detail' item.id %}" class="block">
            <div class="relative w-full h-56 sm:h-64 bg-white">
              {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.name }} image"
                     class="absolute inset-0 h-full w-full object-contain p-2" loading="lazy" />
              {% else %}
                <img src="{% static 'img/placeholder.png' %}" alt="No image"
                     class="absolute inset-0 h-full w-full object-contain p-2" loading="lazy" />
              {% endif %}
            </div>
          </a>

          <!-- Body -->
          <div class="p-5">
            <div class="flex items-start justify-between gap-3">
              <h3 class="text-lg font-bold leading-snug">
                <a href="{% url 'item:detail' item.id %}" class="hover:underline">{{ item.name }}</a>
              </h3>
              <span class="shrink-0 rounded-full px-2.5 py-1 text-xs font-semibold
                           {% if item.is_sold %}bg-rose-100 text-rose-700{% else %}bg-emerald-100 text-emerald-700{% endif %}">
                {% if item.is_sold %}Sold{% else %}Available{% endif %}
              </span>
            </div>

            {% if item.category %}
              <p class="mt-1 text-xs uppercase tracking-wide text-slate-500">{{ item.category.name }}</p>
            {% endif %}

            <p class="mt-2 text-sm text-slate-700">
              Price: <span class="font-semibold">{{ item.price|floatformat:2 }} BHD</span>
            </p>

            <div class="mt-4 flex flex-wrap gap-3">
              <a href="{% url 'item:edit' item.id %}"
                 class="inline-flex items-center rounded-lg border border-slate-300 px-3 py-1.5 text-sm font-semibold hover:bg-slate-50">
                Edit
              </a>

              <form action="{% url 'item:delete' item.id %}" method="post"
                    onsubmit="return confirm('Delete this item?');" class="inline">
                {% csrf_token %}
                <button type="submit"
                        class="inline-flex items-center rounded-lg bg-rose-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-rose-700">
                  Delete
                </button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <!-- Empty state -->
    <div class="mt-8 rounded-xl border border-dashed border-slate-300 bg-white p-10 text-center">
      <p class="text-slate-600">You havenâ€™t created any items yet.</p>
      <a href="{% url 'item:new' %}"
         class="mt-4 inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 font-semibold text-white hover:bg-emerald-700">
        Create your first item
      </a>
    </div>
  {% endif %}
</section>
{% endblock %}
